{"version":3,"file":"CloudUploader.js","mappings":"AAEAA,MAAMC,cAAgBD,MAAME,SAASC,OAAO,CAC1CC,KAAM,SAAUC,EAAUC,GACxBC,KAAKC,KAAKH,EAAUC,GACpBC,KAAKE,SAASC,GAAG,mBAAoBH,KAAKI,SAASC,KAAKL,MAC1D,EACAI,SAAU,SAAUE,EAAGC,GAAM,IAAAC,EAAA,KACrBC,EAAOF,EAAKG,MAAM,GAClBC,EAAWX,KAAKE,SAASU,WAAW,SAAU,YA8BpD,OA5BAL,EAAKM,MAAQpB,MAAMqB,kBAAkB,OAAQ,uBAAwB,CACnEP,KAAM,CACJE,KAAM,CACJM,aAAcN,EAAKM,aACnBC,KAAMP,EAAKO,KACXC,KAAMR,EAAKQ,KACXC,KAAMT,EAAKS,SAIdC,MAAK,SAACC,GAOL,OANAC,OAAOC,OAAOX,EAAUS,EAASb,MACjCc,OAAOC,OAAOf,EAAM,CAClBW,KAAM,MACNK,IAAKH,EAASb,KAAKgB,MAGdf,EAAKN,SAASU,WAAW,OAAQL,EAC1C,IACCY,MAAK,WACJ,OAAOK,EAAEC,KAAK,CACZF,IAAK9B,MAAMiC,aAAa,sBACxBR,KAAM,OACNS,QAASnB,EAAKN,SAASU,WAAW,SAAU,WAC5CL,KAAMI,GAEV,KAEK,CACT","sources":["webpack:///./CloudUploader.js"],"sourcesContent":["/** global: Craft */\n/** global: Garnish */\nCraft.CloudUploader = Craft.Uploader.extend({\n  init: function ($element, settings) {\n    this.base($element, settings);\n    this.uploader.on('fileuploadsubmit', this.onSubmit.bind(this));\n  },\n  onSubmit: function (e, data) {\n    const file = data.files[0];\n    const formData = this.uploader.fileupload('option', 'formData');\n\n    data.jqXHR = Craft.sendActionRequest('POST', 'cloud/get-upload-url', {\n      data: {\n        file: {\n          lastModified: file.lastModified,\n          name: file.name,\n          size: file.size,\n          type: file.type,\n        },\n      },\n    })\n      .then((response) => {\n        Object.assign(formData, response.data);\n        Object.assign(data, {\n          type: 'PUT',\n          url: response.data.url,\n        });\n\n        return this.uploader.fileupload('send', data);\n      })\n      .then(() => {\n        return $.ajax({\n          url: Craft.getActionUrl('cloud/create-asset'),\n          type: 'POST',\n          headers: this.uploader.fileupload('option', 'headers'),\n          data: formData,\n        });\n      });\n\n    return false;\n  },\n});\n"],"names":["Craft","CloudUploader","Uploader","extend","init","$element","settings","this","base","uploader","on","onSubmit","bind","e","data","_this","file","files","formData","fileupload","jqXHR","sendActionRequest","lastModified","name","size","type","then","response","Object","assign","url","$","ajax","getActionUrl","headers"],"sourceRoot":""}